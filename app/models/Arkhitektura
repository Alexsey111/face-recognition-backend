face-recognition-service/
│
├── app/ # Основное приложение
│ ├── __init__.py
│ ├── main.py # ← ТОЧКА ВХОДА (создание FastAPI)
│ ├── config.py # ← КОНФИГ (всё из env переменных)
│ │
│ ├── models/ # Pydantic модели (валидация)
│ │ ├── __init__.py
│ │ ├── request.py # ← UploadRequest, VerifyRequest, LivenessRequest
│ │ ├── response.py # ← UploadResponse, VerifyResponse, LivenessResponse
│ │ ├── user.py # ← UserModel, UserCreate, UserUpdate
│ │ ├── reference.py # ← ReferenceModel
│ │ └── verification.py # ← VerificationSessionModel
│ │
│ ├── routes/ # HTTP Endpoints (API)
│ │ ├── __init__.py
│ │ ├── health.py # ← GET /health, GET /status
│ │ ├── upload.py # ← POST /upload
│ │ ├── verify.py # ← POST /verify
│ │ ├── liveness.py # ← POST /liveness
│ │ ├── reference.py # ← GET /reference, PUT /update-reference
│ │ └── admin.py # ← Admin endpoints (stats, logs, etc)
│ │
│ ├── services/ # Бизнес-логика
│ │ ├── __init__.py
│ │ ├── ml_service.py # ← Вызов ML пайплайна
│ │ ├── database_service.py # ← Работа с БД (обёртка над CRUD)
│ │ ├── encryption_service.py # ← Шифрование/расшифровка эмбеддингов
│ │ ├── storage_service.py # ← Работа с S3/MinIO (загрузка фото)
│ │ ├── webhook_service.py # ← Отправка в CRM (webhook-и)
│ │ ├── validation_service.py # ← Валидация (безопасность, форматы)
│ │ └── cache_service.py # ← Redis кэш (эмбеддинги, токены)
│ │
│ ├── db/ # БД слой (SQLAlchemy ORM)
│ │ ├── __init__.py
│ │ ├── database.py # ← Подключение, SessionLocal, engine
│ │ ├── models.py # ← SQLAlchemy модели (User, Reference, etc)
│ │ └── crud.py # ← CRUD операции (create, read, update, delete)
│ │
│ ├── middleware/ # Middleware (обработка запросов)
│ │ ├── __init__.py
│ │ ├── auth.py # ← JWT валидация, decode token
│ │ ├── rate_limit.py # ← Rate limiting (Redis)
│ │ ├── logging.py # ← Логирование (без биометрии)
│ │ ├── error_handler.py # ← Обработка ошибок
│ │ └── cors.py # ← CORS конфиг
│ │
│ ├── utils/ # Утилиты
│ │ ├── __init__.py
│ │ ├── validators.py # ← Валидация данных (размер, формат)
│ │ ├── exceptions.py # ← Кастомные исключения
│ │ ├── constants.py # ← Константы (таймауты, лимиты)
│ │ ├── logger.py # ← Логгер конфиг
│ │ └── decorators.py # ← Декораторы (@validate, @log, etc)
│ │
│ └── schemas/ # JSON Schemas для OpenAPI
│ ├── __init__.py
│ └── examples.py # ← Примеры для документации
│
├── tests/ # Тесты
│ ├── __init__.py
│ ├── conftest.py # ← Pytest конфиг, fixtures
│ ├── test_api.py # ← Тесты endpoints
│ ├── test_services.py # ← Тесты services
│ ├── test_db.py # ← Тесты БД операций
│ ├── test_encryption.py # ← Тесты шифрования
│ ├── test_auth.py # ← Тесты аутентификации
│ └── integration/
│ ├── test_full_flow.py # ← Full integration tests
│ └── test_webhook.py # ← Webhook тесты
│
├── migrations/ # Alembic миграции БД
│ ├── versions/
│ │ ├── 001_initial.py
│ │ ├── 002_add_audit_logs.py
│ │ └── 003_add_reference_version.py
│ └── env.py
│
├── scripts/ # Вспомогательные скрипты
│ ├── init_db.py # ← Инициализация БД
│ ├── migrate_db.py # ← Запуск миграций
│ └── seed_data.py # ← Заполнение тестовыми данными
│
├── docker/ # Docker конфиги
│ ├── Dockerfile # ← Production image
│ ├── Dockerfile.dev # ← Development image
│ └── docker-compose.yml # ← Local setup
│
├── config/ # Конфигурационные файлы
│ ├── logging.yaml # ← Логирование конфиг
│ ├── openapi.yaml # ← OpenAPI spec
│ └── .env.example # ← Пример env переменных
│
├── requirements.txt # ← Зависимости (pip install -r)
├── requirements-dev.txt # ← Dev зависимости (pytest, black, etc)
├── pyproject.toml # ← Python project config
├── setup.py # ← Setup script
├── pytest.ini # ← Pytest конфиг
├── .gitignore # ← Что не коммитить
├── README.md # ← Документация проекта
├── DEVELOPMENT.md # ← Инструкции для разработчика
└── API.md # ← API документация